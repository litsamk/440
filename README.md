# Cardiotoxicity Transcriptomics Analysis

## Overview

This repository contains code and data to analyze transcriptomic responses to drug treatments in cardiomyocyte cell lines, with a focus on identifying and visualizing cardiotoxicity signatures. The analysis aims to replicate the UMAP plots from Figure 3 of the draft as well as the PCA. The analysis includes data preprocessing, dimensionality reduction (PCA, UMAP), clustering, and figure generation using bulk RNA-seq data. The code is designed to allow users to regenerate the main analysis figure and results.

## Data

The primary dataset consists of gene expression counts and sample metadata for cardiomyocyte cell lines treated with various drugs and DMSO control. The data can be found [GEO Accession GSE217421](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE217421), titled "Transcriptomic profiling of drug-treated human induced pluripotent stem cells (iPSCs)".

- **Expression data:** `GSE217421_raw_counts_GRCh38.p13_NCBI.tsv`
- **Sample metadata:** `Sample_reference.xlsx`
includes label of sample ('Sample name'), the drug it was treated with ('Drug'), the cell line it belongs to ('Cell line'), and which repliate it corresponds to ('Replicate')
- **Drug metadata:** `Drug_reference.txt`
includes code for drug name ('Drug abbreviation'), the name of the drug ('Drug name'), the type of drug it is ('Drug class'), whether it is cardiotoxic  ('Is_cardiotoxic) and to what extent ('Cardiotoxiity frequency') and literature references ('References for cardiotoxicity')



**Data citation:**  
> Churko, J.M., et al. (2023). "Transcriptomic signatures of drug-induced cardiotoxicity in human iPSC-derived cardiomyocytes." GEO Accession GSE217421.

## Folder Structure

project440/
│
├── data/ # Input data files 
│ ├── Sample_reference.xlsx
│ ├── Drug_reference.txt
│ └── GSE217421_raw_counts_GRCh38.p13_NCBI.tsv
│
├── results/ # Output figures and result CSVs
│ ├── pca_plot.png
│ ├── umap_plot.png
│ ├── pca_results.csv
│ └── umap_results.csv
│
├── src/ # Source code
│ └── 440_project.py
│
├── README.md # Project documentation

- **data/**: Contains all input data files required for the analysis. 
- **results/**: Stores all output figures and CSVs generated by the analysis script.
- **src/**: Contains the main analysis script (`440_project.py`).
- **environment.yml**: Lists all dependencies and versions for reproducibility.
- **README.md**: This documentation file.

## Installation

### 1. Clone the repository

- git clone https://github.com/yourusername/cardiotoxicity-transcriptomics-analysis.git
- cd cardiotoxicity-transcriptomics-analysis


### 2. Set up the conda environment

conda env create -f environment.yml
conda activate sc_analysis


### 3. Download the data if trouble with the raw file

One can download the data from [GEO GSE217421](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE217421) and place them in the `data/` directory.

### 4. Download dependencies:


In order to run the code, key packages include:
- Python 3.11
- scanpy
- pandas
- numpy
- matplotlib
- openpyxl
- leidenalg
- scikit-learn
- seaborn
- anndata
- python-igraph
- louvain
- xlrd

Updated versions of these packages can be accessed by installing Miniconda:
bash Miniconda3.sh
OR downlaoad: https://www.anaconda.com/docs/getting-started/miniconda/install 

## Execution

Run the code in the following file: python src/440_project.py

This will generate PCA and UMAP plots and save them, along with result CSVs, in the `results/` folder.

## Citations

- Churko, J.M., et al. (2023). "Transcriptomic signatures of drug-induced cardiotoxicity in human iPSC-derived cardiomyocytes." GEO Accession GSE217421.
- [Scanpy: Single-Cell Analysis in Python](https://scanpy.readthedocs.io/)
- [Leiden algorithm for community detection](https://www.nature.com/articles/s41598-019-41695-z)


**Prepared by:**  
Litsa Kapsalis and Harshit Bhasin
[Project Title: Figure 3A-E: Cardiotoxicity Transcriptomics Analysis]  
[GitHub Repo Link: https://github.com/litsamk/440/tree/branch1
Public

